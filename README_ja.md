# ClippedImgToWSLPath

クリップボードの画像を自動保存し、WSL2パスに変換するWindows用システムトレイ常駐アプリケーション

## 概要

このツールは、Windowsのクリップボードに画像がコピーされたことを検知し、自動的に以下の処理を行います：

1. **自動画像保存**: クリップボードの画像を指定されたフォルダにPNG形式で保存
2. **WSL2パス変換**: 保存した画像のWindowsパス（例：`C:\ClipboardImages\image.png`）をWSL2パス（例：`/mnt/c/ClipboardImages/image.png`）に自動変換
3. **クリップボード更新**: 変換されたWSL2パスを自動的にクリップボードにコピー

これにより、Windows上でコピーした画像をWSL2環境で簡単に参照できるようになります。

## 主な特徴

- システムトレイに常駐し、バックグラウンドで動作
- **Windows+Shift+Sスクリーンショット対応**: Windows標準のスクリーンショット機能に完全対応
- **タイマーベースの監視**: 1秒ごとにクリップボードを監視し、新しい画像を確実に検出
- 重複画像の検出（SHA256ハッシュによる）
- 保存先フォルダのカスタマイズ可能
- 画像保存時に通知を表示
- **デバッグログ機能**: トラブルシューティング用のログ出力オプション
- **自動アイコン生成**: アイコンファイルがない場合は自動生成

## 必要環境

- Windows 10/11
- **.NET SDK 8.0** 以降

## .NET SDK 8.0のインストール

このアプリケーションは.NET 8.0を使用しています。以下のリンクから.NET SDK 8.0をダウンロードしてインストールしてください：

https://dotnet.microsoft.com/download/dotnet/8.0

## ビルド方法

```bash
git clone https://github.com/yourusername/ClippedImgToWSLPath.git
cd ClippedImgToWSLPath
dotnet build
```

## 実行方法

```bash
dotnet run
```

または、ビルド後の実行ファイルを直接実行：

```bash
.\bin\Debug\net8.0-windows\ClippedImgToWSLPath.exe
```

## 使い方

1. アプリケーションを起動するとシステムトレイに常駐します
2. 画像をクリップボードにコピー：
   - **Windows+Shift+S**: Windows標準のスクリーンショット機能
   - **PrintScreen**: 全画面スクリーンショット
   - **Alt+PrintScreen**: アクティブウィンドウのスクリーンショット
   - **Snipping Tool**: Windowsのスニッピングツール
   - その他の画像のコピー操作
3. 自動的に画像が保存され、WSL2パスがクリップボードにコピーされます
4. WSL2環境で`Ctrl+V`でパスを貼り付けて使用できます

## 設定

- **デフォルトの保存先**: アプリケーション実行フォルダ内の`ClipboardImages`フォルダ
- システムトレイアイコンをダブルクリック、または右クリック→「設定」で保存先を変更可能
- **デバッグログ**: システムトレイアイコンを右クリック→「Enable Logging」でログ出力を有効化
  - ログファイル: `clipboard_log.txt`（アプリケーション実行フォルダ内）

## ファイル名形式

保存される画像のファイル名は以下の形式になります：
```
clipboard_yyyyMMdd_HHmmss.png
```
例: `clipboard_20240125_143052.png`

## トラブルシューティング

- **アプリケーションが起動しない場合**：.NET SDK 8.0がインストールされているか確認してください
- **画像が保存されない場合**：
  - 保存先フォルダへの書き込み権限を確認してください
  - デバッグログを有効にして問題を特定してください
- **Windows+Shift+Sで画像が保存されない場合**：
  - アプリケーションが実行中であることを確認してください
  - デバッグログを確認して、クリップボード監視が正常に動作しているか確認してください
- **システムトレイアイコンが表示されない場合**：タスクバーの通知領域の設定を確認してください

## 技術仕様

- **クリップボード監視**: Windows APIとタイマーベースの監視を併用
- **画像形式**: PNG形式で保存
- **重複検出**: SHA256ハッシュによる画像の同一性チェック
- **アイコン生成**: System.Drawing APIを使用した動的アイコン生成